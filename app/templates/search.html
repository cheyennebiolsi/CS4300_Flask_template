<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="/static/owlcarousel/owl.carousel.min.css">
    <link rel="stylesheet" href="/static/owlcarousel/owl.theme.default.min.css">
    <link rel="stylesheet" href="/static/mdb/css/mdb.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <script src="/static/bootstrap-tagsinput.js"></script>
    <link rel="stylesheet" href="/static/bootstrap-tagsinput.css">
    <link rel="stylesheet" href="/static/css/search.css" type="text/css">
    <link rel="stylesheet" href="/static/css/featuredisplay.css" type="text/css">
    <link rel="stylesheet" href="/static/css/recommended.css" type="text/css">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/favicon-96x96.png">
    <script src="/static/typeahead.bundle.js"></script>
    <script src="/static/bloodhound.js"></script>
    <script src="/static/js/Chart.bundle.min.js"></script>
    <script src="/static/aniai.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--        <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Maven+pro"> -->
    <script>
        $(window).on("load", function()  {
            setAnimeExplanation();
            {% if data %}
		document.querySelector("#vis").onclick = function(evt){
			var activePoints = anime_scores.getElementsAtEvent(evt);
			var firstPoint = activePoints[0];
			if (firstPoint !== undefined) {
			        var label = anime_scores.data.labels[firstPoint._index];
                                $('#wordinput').tagsinput('add', {word: label, sign: 'positive'});
                        };
		};
            {% endif %}
            $("#recommended-carousel").owlCarousel( {
                items: 4,
                stagePadding: 100,
                loop: true,
                margin: 30,
                autoWidth: false,
                nav: true,
                navText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>','<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
            $("#suggestion-carousel").owlCarousel( {
                items: 6,
                loop: true,
                margin: 0,
                nav: true,
                navText: ['<i class="fa fa-angle-left" aria-hidden="true"></i>','<i class="fa fa-angle-right" aria-hidden="true"></i>']
            });
        });
        document.addEventListener("DOMContentLoaded", function(event) {
            initializeSearchBars();
            resizeSearchBar();
            {% if data %}
                createLegend();
                {% if prevwords %}
                    var prevwords = '{{prevwords}}';
                    var words = prevwords.split('|');
                    initializeWordSearch(words);
                {% else %}
                    initializeWordSearch([]);
                {% endif %}
                {% if prevsearch %}
                    var prevwords = '{{prevsearch}}';
                    var words = prevwords.split('|');
                    initializeAnimeSearch(words);
                {% else %}
                    initializeAnimeSearch([]);
                {% endif %}
                resizeInfo();
                resizeStatistics();
                resizeTags();
                anime_scores.update();
            {% else %}
                initializeWordSearch([]);
                initializeAnimeSearch([]);
                loadrecommended();
            {% endif %}
            {% if ((filtertrue) and (not sfw_on)) %}
               $('#collapsensfwrating').collapse('toggle');
               $('#collapsensfw').collapse('toggle');
            {% endif %}
            $('.fa[data-toggle="tooltip"]').tooltip();
//            $('.tt_input[data-toggle="tooltip"]').tooltip({trigger: "manual"});
        }
        );
    </script>    
</head>

<body>


    

    <style>
        .tree{
            position: fixed;
            top: 0;
            left: 0;
            width: 400px;
            height: 300px;
            padding:0;
            background: none;
            z-index: -2;
        }
    </style>

    <div class="tree">
        <img src="/static/images/csscherry3.png" style='width: 100%; '>
    </div>
    <div>
        <!--title-->
        <h1 style="padding-top:20%; font-size: 85px; font-family:Futura; color:#efe9e8; text-align:center">
            &ensp;Aniai &#24859
        </h1>
        <!--tag line-->
        <!-- <h1 style="padding-top:20%; font-size: 85px; font-family:Futura; color:white; text-align:center">Let's Find Some Good Anime</h1> -->
        <form id="myform" autocomplete="off"> <!--class = "form-inline global-search" id="myform"> -->
            <div class="form-group">
                <!-- style:"height:30px vertical-align:bottom"> -->
                <div class="input-group mb-3 animeinput">
                    <div class="input-group-prepend"><span>anime<i class="fa fa-question-circle-o" data-toggle="tooltip" data-placement="top" data-html="true" title=""></i></span>
                    </div>
                    <input id="animeinput" class="tagsinput-typeahead" type="text" name="animesearch"/>
                    <div class="input-group-append">
                        <button type="submit" id="submit"><i class="fa fa-search"></i></button>
                    </div>
                </div>
            </div> <!--class = "form-inline global-search" id="myform"> -->
            <div class="form-group"> 
                <div class="input-group mb-3 wordinput">
                    <div class="input-group-prepend"><span>keywords<i class="fa fa-question-circle-o" data-toggle="tooltip" data-placement="bottom" data-html="true" title=""></i></span>
                    </div>
                    <input id="wordinput" class="tagsinput-typeahead" type="text" name="wordsearch"/>
                    <div class="input-group-append">
                        <button id="filter-btn" type = "button" data-toggle="collapse" data-target="#collapseForm" aria-expanded="false" aria-controls="collapseForm">
                            <i class="fa fa-filter" style="margin-right: 3px"></i>Filter
                        </button>
                    </div>
                </div>
             </div>

            <div class="collapse" id="collapseForm">
                <div class="form-group row justify-content-md-around" style="color:white;margin:0; border-bottom-right-radius:10px; border-bottom-left-radius:10px; width:100%">
                    <div class="col-md-6" style="text-align:center">
                        <div class="filter-header">
                            <span>Choose As Many Flavors As You Like</span>
                            <label class="fancy-checkbox" style="color:white;margin: 0">
                                <input type="checkbox" onclick="toggle(this);" checked/>
                                <i class="fa fa-check-square-o checked" data-toggle="tooltip" data-placement="right" title="Deselect all genres?" style="font-size:30px; margin-left:10px; color:green"></i>
                                <i class="fa fa-square-o unchecked" data-toggle="tooltip" data-placement="right" title="Select all genres?" style="font-size:30px; margin-left:10px; padding-right:5px; color:green"></i>
                            </label>
                        </div>
                        <hr>
                        <div class="form-check">
                            
                            {% set genres=['action', 'adventure', 'cars', 'comedy', 'dementia', 'demons', 'drama','fantasy', 'game', 'harem', 'historical', 'horror', 'josei', 'kids', 'magic', 'martial arts', 'mecha', 'military', 'music', 'mystery', 'parody', 'police', 'psychological', 'romance', 'samurai', 'school', 'sci-fi', 'seinen', 'shoujo', 'shoujo-ai', 'shounen', 'shounen-ai', 'slice of life', 'space', 'sports', 'super power', 'supernatural', 'thriller', 'vampire'] %}
                            {% if filtertrue %}
                                {% for genre in genres %}
                                    {% set genre_name = genre.replace(" ", "_") %}
                            <label class="genre-checkbox" style="color:white">
                                <input type="checkbox" name={{genre_name}} id = "sfwgenre" {% if prevfilters2[genre_name] is not none %} checked {% else %} unchecked {% endif%}/>
                                <div class="genre-button-inner active checked">{{genre}}</div>
                                <div class="genre-button-inner inactive unchecked">{{genre}}</div>
                            </label>
                                {% endfor %}
                            {% else %}
                                {% for genre in genres %}
                                    {% set genre_name = genre.replace(" ", "_") %}
                                <label class="genre-checkbox" style="color:white">
                                    <input type="checkbox" name={{genre_name}} id="sfwgenre" checked/>
                                    <div class="genre-button-inner active checked">{{genre}}</div>
                                    <div class="genre-button-inner inactive unchecked">{{genre}}</div>
                                </label>
                                {% endfor %}
                            {% endif %}
                            <div>
                                <div class="collapse" id="collapsensfw">
                                    <div class="form-check">
                                        {% set nsfwgenres=['ecchi', 'hentai', 'yaoi', 'yuri']%}
                                        {% for nsfwgenre in nsfwgenres %}
                                        {% if filtertrue %}
                                        <label class="genre-checkbox" style="color:white">
                                            <input type="checkbox" name={{nsfwgenre}} id="nsfwgenre" {% if prevfilters2[nsfwgenre] is not none %} checked {% else %} unchecked {% endif%}/>
                                            <div class="genre-button-inner active checked">
                                                {{nsfwgenre}}
                                            </div>
                                            <div class="genre-button-inner inactive unchecked">
                                                {{nsfwgenre}}
                                            </div>
                                        </label>

                                        {%else%}
                                        <label class="genre-checkbox" style="color:white">
                                            <input type="checkbox" name={{nsfwgenre}} id="nsfwgenre" unchecked/>
                                            <div class="genre-button-inner active checked">
                                                {{nsfwgenre}}
                                            </div>
                                            <div class="genre-button-inner inactive unchecked">
                                                {{nsfwgenre}}
                                            </div>
                                        </label>
                                        {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>

                    <div class="col-md-auto">
                        <div class="filter-header">
                            <span>Type</span>
                        </div>
                        <hr>
                        <div class="d-flex flex-column justify-content-between">
                        
                        <div class="d-flex flex-row justify-content-between">
                        {% if filtertrue %}                        
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displayTv" {% if prevfilters2['displayTv'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                television
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displayTv" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                television
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white;">
                                <input type="checkbox" name="displayOva" {% if prevfilters2['displayOva'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                OVA
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white;">
                                <input type="checkbox" name="displayOva" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                OVA
                            </label>
                        </div>
                        {% endif %}
                        </div>

                        <div class="d-flex flex-row justify-content-between">
                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displayMovie" {% if prevfilters2['displayMovie'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                movie
                            </label>
                        </div>
                        {% else %}
                         <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displayMovie" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                movie
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white;">
                                <input type="checkbox" name="displayOna" {% if prevfilters2['displayOna'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                ONA
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white;">
                                <input type="checkbox" name="displayOna" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                ONA
                            </label>
                        </div>
                        {% endif %}

                        </div>

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displaySpecial" {% if prevfilters2['displaySpecial'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                special
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="displaySpecial" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                special
                            </label>
                        </div>
                        {% endif %}
                        </div>

                        <div class="filter-header">
                            <span>How You Want To Watch</span>
                        </div>
                        <hr>
                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamCrunchy" {% if prevfilters2['streamCrunchy'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                crunchyroll
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamCrunchy" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                crunchyroll
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamHulu" {% if prevfilters2['streamHulu'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                hulu
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamHulu" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                hulu
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamYahoo" {% if prevfilters2['streamYahoo'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                Yahoo! View
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamYahoo" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                Yahoo! View
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamNone" {% if prevfilters2['streamNone'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                allow no provider
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="streamNone" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                allow no provider
                            </label>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-auto">
                        <div class="form-check filter">
                            {% if filtertrue %}
                            <div class="filter-header">
                                <span> Rated </span>
                                <label id="sfw-collapse" class="genre-checkbox" style="color:white; position:absolute; top:10px">
                                    <input type="checkbox" name="sfw" id="sfw-button" onclick="clearnsfw(this)" data-toggle="collapse" data-target="#collapsensfw, #collapsensfwrating" aria-expanded="false" aria-controls="collapsensfw" {% if sfw_on %} checked {% else %} unchecked {%endif%}/>
                                    <div class="sfw-button unchecked">NSFW ON</div>
                                    <div class="sfw-button active checked">SFW ON</div>
                                </label>
                            </div>
                            {% else %}
                            <div class="filter-header">
                                <span> Rated </span>
                                <label id="sfw-collapse" class="genre-checkbox" style="color:white; position:absolute; top:10px">
                                    <input type="checkbox" name="sfw" id="sfw-button" onclick="clearnsfw(this)" data-toggle="collapse" data-target="#collapsensfw, #collapsensfwrating" aria-expanded="false" aria-controls="collapsensfw" checked/>
                                    <div class="sfw-button unchecked">NSFW ON</div>
                                    <div class="sfw-button active checked">SFW ON</div>
                                </label>
                            </div>
                            {% endif %}
                                <!--<input style="display:inline" type="checkbox" class="form-check-input tag" id="sfwSearch" name="sfwSearch" checked>
                                <label style="display:inline" for="sfwSearch" class="sfw-button active" data-toggle="collapse" data-target="#collapsensfw, #collapsensfwrating" aria-expanded="false" aria-controls="collapsensfw">  SFW ON  </label> -->
                            </div>
                        <!-- </div> -->
                        <hr>

                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="gRating" {% if prevfilters2['gRating'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                G &#8212 all ages
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="gRating" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                G &#8212 all ages
                            </label>
                        </div>
                        {% endif %}
                        
                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="pgRating" {% if prevfilters2['pgRating'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                PG &#8212 children
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="pgRating" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                PG &#8212 children
                            </label>
                        </div>
                        {% endif %}
                        
                        {% if filtertrue %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="pg13Rating" {% if prevfilters2['pg13Rating'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                PG-13 &#8212 teens 13 or older
                            </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                            <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="pg13Rating" checked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                PG-13 &#8212 teens 13 or older
                            </label>
                        </div>
                        {% endif %}

                        {% if filtertrue %}
                        <div class="form-check">
                        <label class="fancy-checkbox" style="color:white">
                        <input type="checkbox" name="r17Rating" {% if prevfilters2['r17Rating'] is not none %} checked {% else %} unchecked {% endif%}/>
                        <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                        <i class="fa fa-fw fa-check checked" style="color:green"></i>
                        R &#8212 17+ (violence & profanity)
                        </label>
                        </div>
                        {% else %}
                        <div class="form-check">
                        <label class="fancy-checkbox" style="color:white">
                        <input type="checkbox" name="r17Rating" checked/>
                        <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                        <i class="fa fa-fw fa-check checked" style="color:green"></i>
                        R &#8212 17+ (violence & profanity)
                        </label>
                        </div>
                        {% endif %}

                        <div class="collapse" id="collapsensfwrating">
                            {% if filtertrue %}
                            <div class="form-check">
                                <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="rPlusRating" id="nsfwrating" {% if prevfilters2['rPlusRating'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                R+ &#8212 mild nudity
                                </label>
                            </div>
                            {% else %}
                            <div class="form-check">
                                <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="rPlusRating" id="nsfwrating" unchecked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                R+ &#8212 mild nudity
                                </label>
                            </div>
                            {% endif %}

                            {% if filtertrue %}
                            <div class="form-check">
                                <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="rxRating" id="nsfwrating" {% if prevfilters2['rxRating'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                Rx &#8212 hentai
                                </label>
                            </div>
                            {% else %}
                            <div class="form-check">
                                <label class="fancy-checkbox" style="color:white">
                                <input type="checkbox" name="rxRating" id="nsfwrating" unchecked/>
                                <i class="fa fa-fw fa-times unchecked" style="color:red"></i>
                                <i class="fa fa-fw fa-check checked" style="color:green"></i>
                                Rx &#8212 hentai
                                </label>
                            </div>
                            {% endif %}
                        </div>

                        <div class="form-check filter" style="border: 2px solid white; padding-bottom: 10px; margin-top: 4px">
                            {% if filtertrue %}
                            <div class="filter-header">
                                <span> Filter Same Series </span>
                                <label class="fancy-checkbox" style="color:white; position:absolute; top:10px">
                                <input type="checkbox" name="filter same series" {% if prevfilters2['filter same series'] is not none %} checked {% else %} unchecked {% endif%}/>
                                <i class="fa fa-check-square-o checked" style="font-size:30px; margin-left:10px; color:green"></i>
                                <i class="fa fa-square-o unchecked" style="font-size:30px; margin-left:10px; color:green"></i>
                                </label>
                            </div>
                            {% else %}
                            <div class="filter-header">
                                <span> Filter Same Series </span>
                                <label class="fancy-checkbox" style="color:white; position:absolute; top:10px">
                                <input type="checkbox" name="filter same series" unchecked/>
                                <i class="fa fa-check-square-o checked" style="font-size:30px; margin-left:10px; color:green"></i>
                                <i class="fa fa-square-o unchecked" style="font-size:30px; margin-left:10px; color:green"></i>
                                </label>
                            </div>
                            {% endif %}
                        </div>
                        <hr hidden>
                    </div>

                </div>             
            </div>
            
        </form>
</div>
        <p style="text-align: center; color: white">{{output_message}} <p>
        {% if data %}
<!--            <br>
            <br>
            <br>
            <br>
            <br>
            <br> -->
            <hr>

            <div class="d-flex flex-column">
                <div class="media-header">
                    <div class="d-flex justify-content-between" id="title-header">
                        <div id="media-title" class="title">
                            <span>{{data[0]["anime_english_title"]}}</span>
                        </div>
                        <div class="col-auto icon" style="font-style:normal">
                            <img src="/static/images/yahoo-view.png" id="yahoo-provider" 
                            {% if not 'yahoo' in data[0]['anime_video_url'] %} hidden {% endif %}>
                            <span style="font-family:FuturaMedium; font-weight: bold; font-size:25; color:lawngreen" id="hulu-provider" 
                            {% if not 'hulu' in data[0]['anime_video_url'] %} hidden {% endif %}>hulu</span>
                            <img src="/static/images/Crunchyroll_24x24.png" style="vertical-align:0" id="crunchyroll-provider-image"
                            {% if not 'crunchyroll' in data[0]['anime_video_url'] %} hidden {% endif %}>
                            <div style="display:inline-block; vertical-align: top" id="crunchyroll-provider"
                                {% if not 'crunchyroll' in data[0]['anime_video_url'] %} hidden {% endif %}>
                                <span style="font-family:Maven pro; font-size:24; display:inline-block; color:white" >crunchyroll </span>
                            </div>
                            <a href="{{data[0]['anime_video_url']}}" role="button" id="video-link" target="_blank" 
                            {% if 'none' == data[0]['anime_video_url'] %} hidden {% endif %}><i class="fa fa-external-link"></i></a>
                        </div>
                    </div>
                    <div class="row" id="episodeinfo">
                        <div class="col type" id="media-type">
                            <span> {{data[0]["anime_type"]}}</span>
                        </div>
                       <div class="col-dot">
                           <div> &#9670 </div>
                       </div>
                       <div class="col rating" id="media-rating">
                           <span> {{data[0]["anime_rating"]}}</span>               
                       </div>
                       <div class="col-dot">
                           <div> &#9670 </div>
                       </div>
                       <div class="col duration" id="media-duration">
                           <span> {{data[0]["anime_duration"]}}</span>
                       </div>
                       <div class="col-dot">
                           <div> &#9670 </div>
                       </div>
                       <div class="col episodes" id="episode-count">
                           <span> {{data[0]["anime_number_of_episodes"]}} episodes</span>
                        </div>
                    </div>

                    <div class="row genres">
                        <div class="col genres" id="media-genres">
                             {% set genrelist = data[0]["anime_tags"].split('|') %} 
                             {% for tag in genrelist %}
                             <span class="genre">{{tag}}</span>
                             {% endfor %}
                        </div>
                    </div>                    
                </div>
                <div class="d-flex justify-content-between" id="feature-display" style="height: 50%">
                    <div id="feature-picture">
                        <div class="container anime-picture">
                            <img src={{data[0]["anime_image_url"]}} class="anime-picture" id="media-image">
                        </div>
                    </div>
                    <div class="d-flex flex-column" style="width: 100%" id="feature-info">
                        <div class="feature-header synopsis-header" id="synopsis-title">Synopsis</div>
                        <div id="media-synopsis"><span>{{data[0]["anime_synopsis"]}}</span></div>
                        <div class="feature-header" id="info-tags">
                            <div class="container anime-words" id="anime-words">
                               <div class="container synopsis-header" id="top-tags"> Top Tags: </div> 
                               <div class="container anime-tags" id="anime-tags">
<!--                                <div class = "container anime-tags" id="anime-tags"> -->
                                    {% set word = " ".join(data[0]["words"].split('|')) %}
                                    <span>{{word}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-column" style="width: 350px" id="feature-score">
                        <div id="similarity-score" class="feature-header synopsis-header"><span>Aniai Score: {{data[0]["score"]}}</span></div>
                        <div class="container anime-statistics">
                        <canvas class="data-visualization" id="vis" width="300" height="300" style="max-height: 100%, max-width: 100%"></canvas>
                        </div>
                        <div id="chart-legends" unselectable="on" class="unselectable">
                                <label class="fancy-checkbox">
                                    <input type="checkbox" onclick="toggleLegendSuggestion(this)" checked/>
                                    <div class="legend-tag checked"><div class="legend-button"></div></div>
                                    <div class="legend-tag unchecked"><div class="legend-button"></div></div>
                                </label>
                                <label class="fancy-checkbox">
                                    <input type="checkbox" onclick="toggleLegendQuery(this)" checked/>
                                    <div class="legend-tag checked"><div class="legend-button"></div></div>
                                    <div class="legend-tag unchecked"><div class="legend-button"></div></div>
                                </label>
                        </div>
                    </div>
                </div>
                <div class="media-footer"> 
                    <div class="container">
                        <div class="row">
                        </div>
                    </div>
                </div>
            </div>
                                <script>
                                    var labels = '{{data[0]["graph_words"]}}';
                                    // for (i = 0; i < labels.length; i++) { 
                                    //     arr.push(decodeEntities(labels[i]))
                                    // }
                                    // console.log(arr
                                    var labels_words = labels.split("|");
                                    console.log(labels_words)

                                    var data_chart = {
                                        labels: labels_words,
                                        datasets: [
                                            {
                                                label: "Query",
                                                fill: true,
                                                backgroundColor: "rgba(152,251,152,0.2)",
                                                borderColor: "rgba(152,251,152,1)",
                                                pointBorderColor: "#fff",
                                                pointBackgroundColor: "rgba(152,251,152,0.2)",
                                                pointBorderColor: "#fff",
                                                data: {{data[0]["original_value"]}}
                                            },
                                            {
                                                label: "{{data[0]["anime_english_title"]}}",
                                                fill: true,
                                                backgroundColor: "rgba(219,112,147,0.2)",
                                                borderColor: "rgba(219,112,147,1)",
                                                pointBorderColor: "#fff",
                                                pointBackgroundColor: "rgba(219,112,147,1)",
                                                pointBorderColor: "#fff",
                                                data: {{data[0]["graph_value"]}}
                                            }
                                        ]
                                    };

                                    anime_scores = new Chart(document.getElementById("vis"), {
                                        type: 'radar',
                                        data: data_chart,
                                        draggable: true,
                                        options: {
                                            legendCallback: function(chart) {
                                                var queryLabel = chart.data.datasets[0].label;
                                                var queryColor = chart.data.datasets[0].backgroundColor;
                                                var queryBorder = chart.data.datasets[0].borderColor;
                                                var suggestionLabel = chart.data.datasets[1].label;
                                                var suggestionColor = chart.data.datasets[1].backgroundColor;
                                                var suggestionBorder = chart.data.datasets[1].borderColor;
                                                var text = 
                                                '<label class="fancy-checkbox">' +
                                                     '<input type="checkbox" onclick="toggleLegendQuery(this)" checked/>' +
                                                     '<div class="legend-tag checked">' + 
                                                     '<div class="legend-button" style="background-color:' + queryColor + '; border-color: ' + queryBorder + '">' + 
                                                     '</div>' + queryLabel + '</div>' + 
                                                     '<div class="legend-tag unchecked">' + 
                                                     '<div class="legend-button" style="background-color:' + queryColor + '; border-color: ' + queryBorder + '">' +
                                                     '</div>' + queryLabel + '</div></label>' + 
                                                '<label class="fancy-checkbox">' +
                                                     '<input type="checkbox" onclick="toggleLegendSuggestion(this)" checked/>' +
                                                     '<div class="legend-tag checked">' + 
                                                     '<div class="legend-button" style="background-color:' + suggestionColor + '; border-color: ' + suggestionBorder + '">' +
                                                     '</div>' + suggestionLabel + '</div>' + 
                                                     '<div class="legend-tag unchecked">' +
                                                     '<div class="legend-button" style="background-color:' + suggestionColor + '; border-color: ' + suggestionBorder + '">' + 
                                                     '</div>' + suggestionLabel + '</div></label>';
                                                return text;
                                            },
                                            hover: {
                                                onHover: function(e) {
                                                    var activePoints = this.getElementAtEvent(e);
                                                    if (activePoints[0] !== undefined) {
                                                        e.target.style.cursor = "pointer";
                                                    } else {
                                                       e.target.style.cursor = "default";
                                                    }
                                                }
                                            },
                                            title: {
                                                display: true,
                                                text: 'Most Similar Words to Query',
                                                fontColor: "#FFFFFF",
                                                fontSize: 14
                                            },
                                            legend: {
                                                display: false,
                                                position: 'bottom',
                                                boxWidth: 20

                                            },
                                            scale: {
                                                ticks: {
                                                    maxTicksLimit: 5,
                                                    backdropColor: 'black',
                                                    max: Math.min(1, Math.max.apply(Math, {{data[0]["original_value"]}}.concat({{data[0]["graph_value"]}})) + 0.1),
                                                    min: 0, 
                                                    fontSize: 6,
                                                    color: '#FFFFFF'
                                                },
                                                gridLines: {
                                                    color: "#FFFFFF"
                                                }
                                            },
                                            tooltips: {
                                                footerFontStyle: 'normal',
                                                callbacks: {
                                                    footer: function(tooltipItem, data) {
                                                        var label = data.labels[tooltipItem[0].index];
                                                        return ['Click to add "' + label + '" to search bar'];
                                                    },
                                                    label: function(tooltipItem, data) {
                                                        var datasetLabel = '';
                                                        var label = data.datasets[tooltipItem.datasetIndex].label;
                                                        return data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index] + " " + label;
                                                    }
                                                },
                                                enabled: true,
                                                mode: 'index'
                                            },
                                            responsive: true,
                                            maintainAspectRatio: false,
                                        }
                                    });

                                </script>
            <div class="owl-carousel owl-theme owl-loaded" style="height: 25%" id="suggestion-carousel">
                <div class="owl-stage-outer">
                    <div class="owl-stage">
                        {% for d in data%}
                        {% set image_url = d['anime_image_url'] %}
                        <div class="owl-item" style="height:100%">
                            <div class="view overlay" id="suggestionCard" style="cursor:pointer" data-index = "{{d['anime_index']}}" data-title = "{{d['anime_english_title']}}"
                                 data-type="{{d['anime_type']}}" data-duration="{{d['anime_duration']}}" data-image="{{d['anime_image_url']}}" 
                                 data-labels='{{ d["graph_words"]}}'
                                 data-values= "{{d['graph_value']}}"
                                 data-overallreview = '{{d["anime_review_overall_average"]}}' 
                                 data-storyreview = '{{d["anime_review_story_average"]}}'
                                 data-enjoyment = '{{d["anime_review_enjoyment_average"]}}'
                                 data-character = '{{d["anime_review_character_average"]}}'
                                 data-sound= '{{d["anime_review_sound_average"]}}'
                                 data-animation= '{{d["anime_review_animation_average"]}}'
                                 data-positive_words = '{{d["positive_words"]}}' 
                                 data-original_value = '{{d["original_value"]}}' 
                                 data-episodes="{{d['anime_number_of_episodes']}}" data-tags="{{d['anime_tags']}}" data-synopsis="{{d['anime_synopsis']}}"  
                                 data-rating="{{d['anime_rating']}}" data-video="{{d['anime_video_url']}}" data-reviewernumber="{{d['anime_review_number']}}" 
                                 data-similarity="{{d['score']}}" data-ratingvalue="{{d['anime_rating_value']}}" data-raternumber="{{d['anime_rating_count']}}" 
                                 data-words="{{d['words']}}" style="height:100%">
                                <div class="well suggestion" style='height: 100%; background-position: center; background-size: cover; background-image: url("{{image_url}}")'></div>
                                <div class="mask flex-center rgba-stylish-strong">
                                    <div class="suggestion-text"> {{d["anime_english_title"]}} </div>
                                 </div>
                            </div>
                         </div>
                         {% endfor %}
                    </div>
                 </div>
           </div>

{% else %}
<h1 style="color: white"> Editors' Choice Anime to Search </h1>

<div class="owl-carousel owl-theme owl-loaded" style="height: 400px" id="recommended-carousel">
    <div class="owl-stage-outer">
        <div class="owl-stage" id="recommendation-stage">
<!--            <div class="owl-item">
            </div> -->
        </div>
    </div>
<!--    <div class="owl-nav">
        <div class="owl-prev">prev</div>
        <div class="owl-next">next</div>
    </div> -->
</div>
        {% endif %}
    </div>

<div class="footer">
   CS4300 Final Project: Aniai | Built by Cheyenne Biolsi (ckb59), Gary Gao (gg392), Arthur Chen (ac2266), Henry Levine (hal59), Kelley Zhang (kz53) | <a href="http://aniai.herokuapp.com/" target="_blank">Prototype1</a> | <a href="http://aniai2.herokuapp.com/" target="_blank">Prototype 2</a> |
</div>
    <!--    <script>
            $.getJSON("/static/data/anime_info.json", function(data) {
                 console.log(data);
                 document.getElementById('anime_info').innerHTML = data;
            });
    </script> -->

    <!--<script type="text/javascript" src="/static/mdb/js/popper.min.js"></script> -->
 
            <script>
                $("#suggestion-carousel").on('click', '.view', function() {
                    var anime_index = $(this).attr('data-index');
                    var anime_image_url = $(this).data("image");
                    var title = $(this).data("title");
                    var type = $(this).data("type");
                    var synopsis = $(this).data("synopsis");
                    var tags = $(this).data("tags");
                    var words = $(this).data("words");
                    var episode_count = $(this).data("episodes");
                    var duration = $(this).data("duration");
                    var rating = $(this).data("rating");
                    var overall = $(this).data("overallreview");  
                    var story = $(this).data("storyreview");  
                    var enjoyment = $(this).data("enjoyment");  
                    var character = $(this).data("character");  
                    var sound = $(this).data("sound");  
                    var animation = $(this).data("animation");
                    var similarity = $(this).data("similarity");
                    var reviewernumber = $(this).data("reviewernumber");
                    var raternumber = $(this).data("raternumber");
                    var ratingvalue = $(this).data("ratingvalue");
                    var thelabels = $(this).data("labels");
                    var thevalues = $(this).data("values");
                    var posiitive_words = $(this).data("positive_words");
                    var original_value = $(this).data("original_value");
                    $('#media-image').attr('src', anime_image_url);
                    $('#media-title span').text(title);
                    $('#media-type span').text(type);
                    $('#media-rating span').text(rating);
                    $('#media-count span').text(episode_count);
                    $('#media-duration span').text(duration);
                    $('#media-synopsis span').text(synopsis);
                    $('#episode-count span').text(episode_count + " episodes");
                    $('#similarity-score span').text("Aniai Score: " + similarity);
                    $('#reviewer-number span').text("Number of Reviewers: " + reviewernumber);
                    $('#rater-number span').text("Number of Raters: " + raternumber);
                    $('#rating-value span').text("Rating: " + ratingvalue);
                    var tags = tags.split("|");
                    var str = "";
                    for (var tag in tags) {
                        str += '<span class="genre">' + tags[tag] + "</span>";
                    };
                    var words = words.split("|");
                    var wordStr = "";
                    for (var word in words) {
                        wordStr += words[word] + " ";
                    };
                    $('#anime-tags span').text(wordStr);
                    $('#media-genres').replaceWith(
                        '<div class="col genres" id="media-genres">' + str + '</div>'
                        );
                    var anime_video_url = $(this).data("video");
                    if (anime_video_url.includes('crunchyroll')) {
                        $('#video-link').attr("href", anime_video_url);
                        $('#video-link').attr("hidden", false);
                        $('#crunchyroll-provider-image').attr("hidden", false);
                        $('#crunchyroll-provider').attr("hidden", false);
                        $('#hulu-provider').attr("hidden", true);
                        $('#yahoo-provider').attr("hidden", true);
                    } else if (anime_video_url.includes('yahoo')) {
                        $('#video-link').attr("href", anime_video_url);
                        $('#video-link').attr("hidden", false);
                        $('#yahoo-provider').attr("hidden", false);
                        $('#hulu-provider').attr("hidden", true);
                        $('#crunchyroll-provider-image').attr("hidden", true);
                        $('#crunchyroll-provider').attr("hidden", true);
                    } else if (anime_video_url.includes('hulu')) {
                        $('#hulu-provider').attr("hidden", false);
                        $('#yahoo-provider').attr("hidden", true);
                        $('#video-link').attr("href", anime_video_url);
                        $('#video-link').attr("hidden", false);
                        $('#crunchyroll-provider-image').attr("hidden", true);
                        $('#crunchyroll-provider').attr("hidden", true);
                    } else {
                        $('#video-link').attr("href", anime_video_url);
                        $('#video-link').attr("hidden", true);
                        $('#crunchyroll-provider-image').attr("hidden", true);
                        $('#crunchyroll-provider').attr("hidden", true);
                        $('#hulu-provider').attr("hidden", true);
                        $('#yahoo-provider').attr("hidden", true);
                    };

                    anime_scores.destroy(); //delete charts
                    // var oldchart = document.getElementById("vis")
                    // if (oldchart !== undefined)
                    //     oldchart.destroy(); //delete charts

                    // var data_chart = {
                    // labels: ["Overall", "Story", "Enjoyment", "Characters", "Sound", "Animation"],
                    // datasets: [
                    //     {
                    //         label: title,
                    //         fill: true,
                    //         backgroundColor: "rgba(255,99,132,0.2)",
                    //         borderColor: "rgba(255,99,132,1)",
                    //         pointBorderColor: "#fff",
                    //         pointBackgroundColor: "rgba(255,99,132,1)",
                    //         pointBorderColor: "#fff",
                    //         data: [
                    //             Math.round(overall*100)/100, 
                    //             Math.round(story*100)/100, 
                    //             Math.round(enjoyment*100)/100,
                    //             Math.round(character*100)/100, 
                    //             Math.round(sound*100)/100,
                    //             Math.round(animation*100)/100
                    //         ]
                    //     }
                    // ]
                    // };
                    var thelabels2 = thelabels.split("|");

                    var data_chart = {
                    labels: thelabels2,
                    datasets: [
                        {
                            label: "Query",
                            fill: true,
                            backgroundColor: "rgba(152,251,152,0.2)",
                            borderColor: "rgba(152,251,152,1)",
                            pointBorderColor: "#fff",
                            pointBackgroundColor: "rgba(152,251,152,0.2)",
                            pointBorderColor: "#fff",
                            data: original_value
                        },
                        {
                            label: title,
                            fill: true,
                            backgroundColor: "rgba(219,112,147,0.2)",
                            borderColor: "rgba(219,112,147,1)",
                            pointBorderColor: "#fff",
                            pointBackgroundColor: "rgba(219,112,147,1)",
                            pointBorderColor: "#fff",
                            data: thevalues
                        }
                    ]
                    };



			    anime_scores = new Chart(document.getElementById("vis"), {
				type: 'radar',
				data: data_chart,
				draggable: true,
				options: { 
                                            legendCallback: function(chart) {
                                                var queryLabel = chart.data.datasets[0].label;
                                                var queryColor = chart.data.datasets[0].backgroundColor;
                                                var queryBorder = chart.data.datasets[0].borderColor;
                                                var suggestionLabel = chart.data.datasets[1].label;
                                                var suggestionColor = chart.data.datasets[1].backgroundColor;
                                                var suggestionBorder = chart.data.datasets[1].borderColor;
                                                var text = 
                                                '<label class="fancy-checkbox">' +
                                                     '<input type="checkbox" onclick="toggleLegendQuery(this)" checked/>' +
                                                     '<div class="legend-tag checked">' + 
                                                     '<div class="legend-button" style="background-color:' + queryColor + '; border-color: ' + queryBorder + '">' + 
                                                     '</div>' + queryLabel + '</div>' + 
                                                     '<div class="legend-tag unchecked">' + 
                                                     '<div class="legend-button" style="background-color:' + queryColor + '; border-color: ' + queryBorder + '">' +
                                                     '</div>' + queryLabel + '</div></label>' + 
                                                '<label class="fancy-checkbox">' +
                                                     '<input type="checkbox" onclick="toggleLegendSuggestion(this)" checked/>' +
                                                     '<div class="legend-tag checked">' + 
                                                     '<div class="legend-button" style="background-color:' + suggestionColor + '; border-color: ' + suggestionBorder + '">' +
                                                     '</div>' + suggestionLabel + '</div>' + 
                                                     '<div class="legend-tag unchecked">' +
                                                     '<div class="legend-button" style="background-color:' + suggestionColor + '; border-color: ' + suggestionBorder + '">' + 
                                                     '</div>' + suggestionLabel + '</div></label>';
                                                return text;
                                            },
                                            hover: {
                                                onHover: function(e) {
                                                    var activePoints = this.getElementAtEvent(e);
                                                    if (activePoints[0] !== undefined) {
                                                        e.target.style.cursor = "pointer";
                                                    } else {
                                                       e.target.style.cursor = "default";
                                                    }
                                                }
                                            },
                            title: {
                                display: true,
                                text: 'Most Similar Words to Query',
                                fontColor: "#FFFFFF",
                                fontSize: 14
                            },
                            legend: {
                                display: false,
                                position: 'bottom',
                                boxWidth: 20

                            },
                            scale: {
                                ticks: {
                                    maxTicksLimit: 5,
                                    backdropColor: 'black',
                                    max: Math.min(Math.max.apply(Math, original_value.concat(thevalues)) + 0.1, 1.0),
                                    min: 0, 
                                    fontSize: 6,
                                    color: '#FFFFFF'
                                },
                                gridLines: {
                                    color: "#FFFFFF"
                                }
                            },
                                            tooltips: {
                                                footerFontStyle: 'normal',
                                                callbacks: {
                                                    footer: function(tooltipItem, data) {
                                                        var label = data.labels[tooltipItem[0].index];
                                                        return ['Click to add "' + label + '" to search bar'];
                                                    },
                                                    label: function(tooltipItem, data) {
                                                    var datasetLabel = '';
                                                    var label = data.datasets[tooltipItem.datasetIndex].label;
                                                    return data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index] + " " + label;
                                                    }
                                                },
                                                enabled: true,
                                                mode: 'index'
                                            },
                            responsive: true,
                            maintainAspectRatio: false,
                        }
                    });
                  createLegend();

                });
                  </script>
    <script>
        var loadrecommended = function() {
            $.getJSON("/static/data/anime_recommended.json", function(data) {
                var str = "";
                data.forEach(function(anime) {
                str += '<div class="owl-item">' + 
                            '<div class="flip">' + 
                                '<div class="recommend-card">' + 
                                    '<div class="face front">' + 
                                        '<div class="well well-sm inner" style="background-image: url(' + encodeURI(anime.anime_image_url) + '); background-size: cover; background-position: center"></div>' + 
                            '</div>' + 
                            '<div class="face back">' +
                                '<div class="well well-sm inner">' + 
                                    '<div class="recommendation-header">' + anime.anime_english_title +
                                    '</div>' + 
                                    '<p id="recommendation-synopsis">' + anime.anime_synopsis + '</p>' + 
                                '</div>' +
                           ' </div>' + 
                        '</div>' +
                    '</div>' +
            '</div>'
                });
              $('#recommendation-stage').replaceWith(
                  '<div class="owl-stage" id="recommendation-stage">' + str + '</div>');
              
              $(document).on("click", ".flip", function() {
                  $(this).find('.recommend-card').toggleClass('flipped');
              });
                
        });
        };
    </script>

    <script>
        $('.flip').click(function() {
            $(this).find('.recommend-card').toggleClass('flipped');
        });
        var resizeChart = function() {
            var bb = document.querySelector("#anime-statistics").getBoundingClientRect();
            $('#vis').attr("width", bb.width);
        };
        var resizeSearchBar = function() {
            var form = document.querySelector("#myform").getBoundingClientRect();
            $('.bootstrap-tagsinput').css("width", form.width - 88*2);
        };
        var resizeStatistics = function() {
            var statistics = document.querySelector("#feature-score").getBoundingClientRect();
            var similarity = document.querySelector("#similarity-score").getBoundingClientRect();
            var legends = document.querySelector("#chart-legends").getBoundingClientRect();
            var height = statistics.height - similarity.height - legends.height - 2;
            console.log(height);
            $('.anime-statistics').css("height", height + "px");
            $('.anime-statistics').css("max-height", height + "px");
	};
		var resizeInfo = function() {
		    var display = document.querySelector("#feature-display").getBoundingClientRect();
		    var score = document.querySelector("#feature-score").getBoundingClientRect();
		    var picture = document.querySelector("#feature-picture").getBoundingClientRect();
		    $('#feature-info').css("width", display.width - score.width - picture.width + "px");

		    var title = document.querySelector("#synopsis-title").getBoundingClientRect();
		    var info = document.querySelector("#feature-info").getBoundingClientRect();
		    var words = document.querySelector("#info-tags").getBoundingClientRect();
		    $('#media-synopsis').css("height", info.height - title.height - words.height + "px");
		};
		var resizeTags = function() {
		    var words = document.querySelector(".anime-words").getBoundingClientRect();
		    var topTags = document.querySelector(".anime-words .synopsis-header").getBoundingClientRect();
		    $('#anime-tags').css("width", words.right - topTags.right - 15 + "px");
		};
		function toggle(source) {
		    var checkboxes = document.querySelectorAll('#sfwgenre');
		    for (var i = 0; i < checkboxes.length; i++) {
			if (checkboxes[i] != source) {
			    checkboxes[i].checked = source.checked;
			};
		    };
		    if (!(document.querySelector('#sfw-button').checked)) {
			var checkboxes = document.querySelectorAll('#nsfwgenre');
			for (var i = 0; i < checkboxes.length; i++) {
			    checkboxes[i].checked = source.checked;
			}
		    };
		};
		function clearnsfw(source) {
		    if (source.checked) {
			var genres = document.querySelectorAll('#nsfwgenre');
			for (var i = 0; i < genres.length; i++) {
			    genres[i].checked = false;
			};
			var ratings = document.querySelectorAll('#nsfwrating');
			for (var i = 0; i < ratings.length; i++) {
			    ratings[i].checked = false;
			};
		    };
		};
		function toggleLegendQuery(source) {
		    anime_scores.data.datasets[0].hidden = !(source.checked);
		    anime_scores.update();
		};
		function toggleLegendSuggestion(source) {
		    anime_scores.data.datasets[1].hidden = !(source.checked);
		    anime_scores.update();
		};
		$(document).on("mouseenter", "#anime-tags span", function() {
		    var bb = document.querySelector("#anime-tags").getBoundingClientRect();
		    width = bb.right - bb.left;
		    if (width < document.querySelector("#anime-tags span").getBoundingClientRect().width) {
			$("#anime-tags span").css("transform", "translateX(calc(" + width+"px - 100%))");
		    };
		});
		$(document).on("mouseleave", "#anime-tags span", function() {
		    $(".anime-tags span").css("transform", "translate(0)");
		});
		$(window).resize(function() {
                    resizeSearchBar();
                    resizeAnimeSearchBar();
                    resizeWordSearchBar();
		    resizeInfo();
		    resizeTags();
		    resizeStatistics();
            anime_scores.update();
        });
       $('[data-toggle="collapse"]').click(function(e) {
            if($($(this).data('target')).hasClass('collapsing'))
            return false;
    });
    </script>
    <script src="/static/owlcarousel/owl.carousel.min.js"></script>
</body>
</html>
